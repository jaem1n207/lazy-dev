#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"
. "$(dirname -- "$0")/common.sh"
. "$(dirname "$0")/../git-hooks/pre-console.sh"

npx lint-staged

images=$(git diff --cached --name-only --diff-filter=ACM | grep -E "\.(png|jpe?g)$")
[ -z "$images" ] && exit 0
echo "$images" | imageoptim 'content/**/*.png' && git add $images